<!DOCTYPE html><html prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>python+django实现登陆功能（下篇） · Let's go for a walk around the world - zuo</title><meta name="description" content="python+django实现登陆功能（下篇） - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_1472710214_6648843.css"><link rel="stylesheet" href="//raw.githack.com/xwartz/hexo-theme-nuna/next/source/style/main.css?v=1.0.3"></head><body class="pupa"><div class="loading-bar"></div><main><div class="post post"><article itemscope itemtype="http://schema.org/Article" class="hentry"><div class="container"><div class="entry-header"><h1 class="entry-title">python+django实现登陆功能（下篇）</h1><div class="entry-description"></div><div class="entry-meta"><time itemprop="datePublished" datetime="Wednesday, February 7th 2018, 10:00:00 pm" class="updated">Feb 7, 2018</time><em class="post-count">1,971 words</em></div></div><div itemprop="articleBody" class="entry-content"><p>在<a href="http://lipeilipei.top/2017/11/07/python+django实现登陆功能（上篇）" target="_blank" rel="external">《python+django实现登陆功能（上篇）》</a>介绍了django的安装配置，本片文章介绍如何用django快速实现登陆功能，开始之前先打开上篇创建的项目，并启动django服务。</p>
<h2 id="Django的MTV模型"><a href="#Django的MTV模型" class="headerlink" title="Django的MTV模型"></a>Django的MTV模型</h2><blockquote>
<p>M 代表模型（Model），即数据存取层。 该层处理与数据相关的所有事务： 如何存取、如何验证有效性、包含哪些行为以及数据之间的关系等。<br>T 代表模板(Template)，即表现层。 该层处理与表现相关的决定： 如何在页面或其他类型文档中进行显示。<br>V 代表视图（View），即业务逻辑层。 该层包含存取模型及调取恰当模板的相关逻辑。 你可以把它看作模型与模板之间的桥梁。</p>
</blockquote>
<p>除了以上三层之外，还需要一个URL分发器，它的作用是将一个个URL的页面请求分发给不同的View处理，View再调用相应的Model和Template</p>
<h5 id="django工作流程示意图"><a href="#django工作流程示意图" class="headerlink" title="django工作流程示意图"></a>django工作流程示意图</h5><p><img src="http://otlbf411d.bkt.clouddn.com/18-2-8/7406559.jpg" alt=""><br>用户请求对应的地址后，经过views.py文件中函数的处理，渲染后的数据加载到html返回给用户，urls.py、views.py、../templates/xx.html这几个文件在下文中会频繁用到。</p>
<hr>
<h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><p>在之前已经创建好的../sign/templates目录下，新建一个index.html文件，代码如下。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Rayvision Test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Rayvision Test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h5 id="GET请求登陆"><a href="#GET请求登陆" class="headerlink" title="GET请求登陆"></a>GET请求登陆</h5><p><code>form</code>标签的method属性设置为get，提交的时候将以get方式去请求。<br>浏览器打开这个html文件，填写之前创建好的账号并登陆，可以看到提交的参数添加到了URL中，<code>username</code>和<code>password</code>为HTML代码中<code>input</code>标签的name属性。<br><img src="http://otlbf411d.bkt.clouddn.com/18-2-5/34357987.jpg" alt=""></p>
<h5 id="POST请求登陆"><a href="#POST请求登陆" class="headerlink" title="POST请求登陆"></a>POST请求登陆</h5><p>一般网站登陆的请求大都是post请求，这里我们将form标签的method属性修改成post，然后再去登陆。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p><img src="http://otlbf411d.bkt.clouddn.com/18-2-5/35843014.jpg" alt=""><br>此时发现返回状态码403，禁止访问，这是因为django针对CSRF(跨站请求伪造)有保护措施，在生成的每个表单中放置一个自动生成的令牌，通过这个令牌判断POST请求是否来自同一个网站。</p>
<ul>
<li>解决办法一：<br>在上面的HTML中使用django的模板标签添加CSRF令牌，在form表单中添加如下。<br><img src="http://otlbf411d.bkt.clouddn.com/18-2-5/71324495.jpg" alt=""><br></li>
<li>解决办法二：<br>直接忽略这个CSRF检查，在../guest/settings.py文件中注释掉csrf，如下图。<br><img src="http://otlbf411d.bkt.clouddn.com/18-2-5/51645928.jpg" alt=""></li>
</ul>
<p>再去请求登陆就不会报错，此时请求登陆后没有任何反应，因为还没有设置登录后跳转的地方。</p>
<hr>
<h2 id="处理登陆请求"><a href="#处理登陆请求" class="headerlink" title="处理登陆请求"></a>处理登陆请求</h2><p>现在已经写好了请求的前端，也有了请求参数，接下来就是交给django服务器来处理请求，首先通过form表单的action属性来指定提交的路径。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"/login_action/"</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>再打开../guest/urls.py文件添加/login_action/的路由。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sign <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    ...</div><div class="line">    url(<span class="string">r'^login_action/'</span>, views.login_action),</div></pre></td></tr></table></figure></p>
<p>然后在../sign/views.py文件编写处理登陆的login_action函数。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> auth</div><div class="line"></div><div class="line"><span class="comment">#登陆</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_action</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</div><div class="line">        username = request.POST.get(<span class="string">'username'</span>, <span class="string">''</span>)</div><div class="line">        password = request.POST.get(<span class="string">'password'</span>, <span class="string">''</span>)</div><div class="line">        user = auth.authenticate(username=username, password=password)</div><div class="line">        <span class="keyword">if</span> user <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            auth.login(request, user) <span class="comment"># 登录</span></div><div class="line">            request.session[<span class="string">'user'</span>] = username <span class="comment"># 将session信息记录到浏览器</span></div><div class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'login success!'</span>)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> render(request,<span class="string">'index.html'</span>, &#123;<span class="string">'error'</span>: <span class="string">'username or password error!'</span>&#125;)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> render(request,<span class="string">'index.html'</span>)</div></pre></td></tr></table></figure></p>
<ol>
<li><p>首先判断请求的方法是否是POST，不是的话返回该页面。</p>
</li>
<li><p><code>request.POST.get</code>方法获取前端传入的用户名和密码，此处的username和password就是html文件里form表单部分那两个input标签的name属性。</p>
</li>
<li><p>django已经帮我们做好用户体系，使用<code>authenticate()</code>函数认证传入的用户名和密码。它接受两个参数，用户名 username 和密码 password，与数据库中的账户做对比，用户名密码正确的情况下返回给user对象。如果用户名密码不正确，则authenticate()返回 None。</p>
</li>
<li><p>if语句判断authenticate()返回如果不为 None，说明用户认证通过，接下来调用 auth.login()函数进行登陆，通过HttpResponse类返回登陆成功的提示。</p>
</li>
<li><p>认证失败的话，则提示用户名或密码错误，现在页面上没有显示错误提示的地方，这里我们再次用到django的模板语言，在密码输入框下方添加，它对应登陆函数中render返回字典中的 key，并且在登录失败的页面中显示 value，即”username or password error!”信息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    &#123;&#123; error &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h5><p><img src="http://otlbf411d.bkt.clouddn.com/18-2-6/75076248.jpg" alt="登陆成功"><br><img src="http://otlbf411d.bkt.clouddn.com/18-2-6/60534329.jpg" alt="登陆失败"></p>
<hr>
<h2 id="增强与美化"><a href="#增强与美化" class="headerlink" title="增强与美化"></a>增强与美化</h2><p>上面我们已经实现了基本的登陆功能，但是是比较粗糙的，登陆成功后只临时用HttpResponse类提示，没有实际意义，页面也不够美观，接下来再写一个登陆成功后跳转的主页，并将登陆页面稍作美化。</p>
<h5 id="登陆界面美化"><a href="#登陆界面美化" class="headerlink" title="登陆界面美化"></a>登陆界面美化</h5><p>这里推荐一个比较优秀的前端框架<a href="https://semantic-ui.com/" target="_blank" rel="external"><strong>Semantic UI</strong></a>，相比于Bootstrap和Foundation，它最大的特点就是非常的语义化，定制化也比较方便。<br>在本地或者网络上导入semantic.css，若在本地导入的话，将下载的semantic.css文件放在../static/css/目录下，然后把之前做好的登陆页面稍作修改。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Rayvision Test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"../static/css/semantic.css"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(230,230,230)"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui center aligned grid"</span> <span class="attr">style</span>=<span class="string">"margin-top: 200px"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui six wide column"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"ui teal header"</span>&gt;</span>RAYVISION - TEST<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui segment"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui content"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"ui form"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"/login_action/"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        &#123;&#123; error &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"ui fluid large teal button"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h5 id="登录后页面"><a href="#登录后页面" class="headerlink" title="登录后页面"></a>登录后页面</h5><p>在../sign/templates目录下，新建一个test_manage.html文件，在里面写好需要的内容。<br>然后在../sign/views.py文件中之前写好的login_action函数做修改，将<code>HttpResponse</code>改为<code>HttpResponseRedirect</code>，它可以对路径进行重定向，从而将登录成功之后的请求指向/test_manage/目录。<br>接着在views.py文件中继续创建 test_manage 函数，用于返回test_manage.html 面页。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse,HttpResponseRedirect</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> auth</div><div class="line"></div><div class="line"><span class="comment">#登陆</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_action</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</div><div class="line">        username = request.POST.get(<span class="string">'username'</span>, <span class="string">''</span>)</div><div class="line">        password = request.POST.get(<span class="string">'password'</span>, <span class="string">''</span>)</div><div class="line">        user = auth.authenticate(username=username, password=password)</div><div class="line">        <span class="keyword">if</span> user <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            auth.login(request, user) <span class="comment"># 登录</span></div><div class="line">            request.session[<span class="string">'user'</span>] = username <span class="comment"># 将session信息记录到浏览器</span></div><div class="line">            response = HttpResponseRedirect(<span class="string">'/test_manage/'</span>)</div><div class="line">            <span class="keyword">return</span> response</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> render(request,<span class="string">'index.html'</span>, &#123;<span class="string">'error'</span>: <span class="string">'username or password error!'</span>&#125;)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> render(request,<span class="string">'index.html'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#测试项目管理页面</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_manage</span><span class="params">(request)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">"test_manage.html"</span>)</div><div class="line">    ...</div></pre></td></tr></table></figure></p>
<p>最后不要忘记在../guest/urls.py 文件中添加路径 test_manage/的路由。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="keyword">from</span> sign <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    ...</div><div class="line">    url(<span class="string">r'^test_manage/$'</span>, views.event_manage),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h5 id="效果图-1"><a href="#效果图-1" class="headerlink" title="效果图"></a>效果图</h5><p><img src="http://otlbf411d.bkt.clouddn.com/18-2-7/51672167.jpg" alt=""></p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>django实现登陆功能上下篇已经完结，但是这里介绍的是最基本的登陆功能，用的是django自动生成的user表里的数据，也仅仅实现了主流程，具体项目中按照需要创建新的数据表，根据严谨的测试思维，我们在开发阶段就要尽可能多的想到异常场景，例如用户名密码为空，特殊字符，长度限制等，在前面的登陆处理函数中通过if来判断，另外我们的请求是将密码明文发送出去的，相当不安全，因此还需再实际使用过程中引入所需的加密模块将密码加密。</p>
<hr>
<h3 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h3><p><a href="http://lipeilipei.top/2017/11/07/python+django实现登陆功能（上篇）" target="_blank" rel="external">python+django实现登陆功能（上篇）</a></p>
<font color="white">xx</font>
</div><div class="entry-extra"><div class="entry-tags"><a href="/tags/django/" class="tag">django</a><a href="/tags/semantic-UI/" class="tag">semantic UI</a><a href="/tags/html/" class="tag">html</a><a href="/tags/css/" class="tag">css</a></div></div></div></article></div></main><footer><div class="copyright container"><p>© Copyright 2018 by <a href="http://yoursite.com">John Doe</a>.</p></div></footer><script async src="//cdn.bootcss.com/mathjax/2.7.0-beta.0/MathJax.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-69822347-1",'auto');
ga('set', 'appName',"Let's go for a walk around the world - zuo");
ga('send','pageview');</script><script>(function () { var sid =500303098;cid =500303108;var hm = document.createElement('script');
hm.src = 'http://pingjs.qq.com/h5/stats.js';
hm.setAttribute('name', 'MTAH5'); hm.setAttribute('sid', sid); hm.setAttribute('cid', cid);
var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);
}())</script><script>var _vds = _vds || [];
window._vds = _vds;
(function(){
  ;_vds.push(['setAccountId',"90b580e047dd0007"  ]);
  (function() {
      var vds = document.createElement('script');
      vds.type='text/javascript';
      vds.async = true;
      vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(vds, s);
  })();
})();</script><script async src="//raw.githack.com/Easyfood/pageAccelerator/master/dist/page-accelerator.min.js"></script><script async src="/script/loading.js"></script><script async src="/script/photo.js"></script></body></html>